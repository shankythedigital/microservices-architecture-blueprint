flowchart TB
    subgraph Clients
        A[Web App / Mobile App / Admin Portal]
    end

    A --> B[API Gateway--(Ingress Controller)]

    subgraph K8s[Kubernetes Cluster]
        subgraph CoreServices[Core Microservices]
            B --> C1[Auth Service--(JWT/OAuth2)]
            B --> C2[User Mgmt--(Profiles, RBAC)]
            B --> C3[Notification Service--(Email, SMS, WhatsApp)]
            B --> C4[Payment Service--(PCI DSS, Wallet)]
            B --> C5[Loyalty Service--(Points, Vouchers)]
            B --> C6[Reporting Service--(MIS, BI)]
            B --> C7[File/Doc Service--(S3, OCR, MinIO)]
            B --> C8[Audit & Compliance--(GDPR, Trails)]
            B --> C9[Scheduler/Job Service--(Quartz, Batch)]
        end

        subgraph SharedInfra[Shared Infrastructure]
            D1[Service Registry--(Eureka/Consul)]
            D2[Config Server--(Spring Cloud Config)]
            D3[Message Broker--(Kafka/RabbitMQ)]
            D4[Cache--(Redis Cluster)]
            D5[Search Engine--(Elasticsearch)]
            D6[Secrets Mgmt--(Vault)]
        end
    end

    subgraph Databases[Databases - Polyglot Persistence]
        DB1[(PostgreSQL/MySQL)]
        DB2[(MongoDB)]
        DB3[(Redis Cache)]
        DB4[(Elasticsearch)]
    end

    subgraph ExternalSaaS[External SaaS / 3rd Party APIs]
        S1[Payment Gateway API--(Stripe/Razorpay/PayPal)]
        S2[SMS/WhatsApp Provider--(Twilio, Meta API)]
        S3[Email Provider--(SendGrid, SES)]
    end

    subgraph Observability[Observability & Monitoring]
        O1[Logging--(ELK/EFK Stack)]
        O2[Monitoring--(Prometheus+Grafana)]
        O3[Tracing--(OpenTelemetry+Jaeger)]
    end

    subgraph DevOps[CI/CD & Platform Layer]
        V1[CI/CD--(Jenkins/GitHub Actions)]
        V2[Container Registry]
        V3[Helm Deployments]
    end

    %% Connections
    CoreServices --> Databases
    CoreServices --> SharedInfra
    CoreServices --> ExternalSaaS
    SharedInfra --> Observability
    Databases --> Observability
    CoreServices --> Observability
    Observability --> DevOps
    SharedInfra --> DevOps
    Databases --> DevOps
    ExternalSaaS --> Observability
